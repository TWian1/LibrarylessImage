def main():
  intro = []
  frames = 128
  quality = 80
  text, textl, texth = textgen("Hello, World!", return_size=True, background_opacity=40)
  for a in range(frames):
    wave = (0.25*(a/quality)%1)*((-0.25*(a/quality))%1)*4
    print(str(a) + "/" + str(frames))
    loading = "["
    for b in range(8):
      if floor((a/frames)*8) > b:
        loading += "⬜"
      else: loading += "⬛"
    print(loading)
    test,scale = [],1
    for c in range(quality):
      test.append([])
      for k in range(quality): test[c].append([round(wave*c), round(wave*k), round(wave*c), 255])
    b = floor(a*2.5)
    if b > 255: b = 255
    intro.append(imgPrint(combine(test, upscale(text, scale, quality, quality), round((quality/2)-((textl/2)*scale)), round((quality/2)-((texth/2)*scale)), 255-b), True))
    print('\033[2A', end='\x1b[2K')
  videoPrint(intro)

def floor(x):
  if x < round(x): return (round(x)-1)
  return round(x)
def upscale(pixelsarray, scale, limx, limy):
  out = []
  for a in range(len(pixelsarray)*scale):
    out.append([])
    for b in range(len(pixelsarray[0])*scale):out[a].append([])
  for a in range(len(pixelsarray)):
    for b in range(len(pixelsarray[0])):
      for c in range(scale):
        for d in range(scale): out[(a*scale)+c][(b*scale)+d] = pixelsarray[a][b]
  return out
def imgPrint(pixelsarray,pre=False):
  height,width,total = len(pixelsarray),len(pixelsarray[0]),[]
  for a in range(floor(height/2)):
    string_temp = ""
    for b in range(width):
      clr = [0,0,0,0,0,0]
      try:
        for c in range(3): clr[c] = pixelsarray[floor(a*2)+1][floor(b)][c]
        for c in range(3): clr[c+3] = pixelsarray[floor(a*2)][floor(b)][c]
      except Exception: pass
      string_temp += f"\033[38;2;{clr[0]};{clr[1]};{clr[2]}m\033[48;2;{clr[3]};{clr[4]};{clr[5]}m▄\033[0m"
    if pre == False: print(string_temp)
    else: total.append(string_temp)
  if pre: return total
def combine(original, image, x, y, alpha=255):
  orig = original
  for a in range(len(original)):
    for b in range(len(original[0])):
      if a >= y and b >= x and b <= x+len(image[0]) and a<=y+len(image):
        try:
          alpha2 = (image[a-y][b-x][3]/255)*(alpha/255)
          orig[a][b] = [round((orig[a][b][z]*(1-alpha2))+(image[a-y][b-x][z] * alpha2)) for z in range(3)]
        except Exception: pass
  return orig
def videoPrint(arrays):
  upcurs = int(len(arrays[0]))
  print(upcurs)
  for x in arrays:
    for b in x: print(b)
    print(f'\033[{upcurs}A', end='\x1b[2K')
def textgen(text, text_color=[255, 255, 255], text_opacity=255, background_opacity=0,  background_color=[0,0,0], return_size=False):
  valtext = "AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789,./\\?!()+-_:;'\""
  data = ['100000110000011000001011111001000100100010001010000101000001000', '011011001111001001111000101110', '111111010000011000001100000110000101111100100001010000101111100', '111101000110001111101000010000', '001111001000011000000100000010000001000000100000001000010011110', '011101000110000100001000101110', '111110010000101000001100000110000011000001100000110000101111100', '011111000110001011110000100001', '111111110000001000000100000011111111000000100000010000001111111', '011101000111100100101000101110', '100000010000001000000100000011111111000000100000010000001111111', '010001000100111001000011', '001110001000101000001100000110011101000000100000001000000011100', '011100000101111100011001101101', '100000110000011000001100000111111111000001100000110000011000001', '100011000111001101101000010000', '111111100010000001000000100000010000001000000100000010001111111', '111101', '011111010000010000001000000100000010000001000000100000010000001', '011101000100001000010000000001', '100000110000101000100100100011100001001000100010010000101000001', '100110101100101010011000', '111111110000001000000100000010000001000000100000010000001000000', '011010101010', '100000110010011001001101010110101011010101110001111000111000001', '1010110101101011101010000', '100000110000111000101100010110010011010001101000111000011000001', '1000110001100011100110110', '011111010000011000001100000110000011000001100000110000010111110', '0111010001100011000101110', '100000010000001000000111111010000011000001100000110000010111110', '100010001110100110010110', '001110101000101000101100000110000011000001100000101000100011100', '000110001001110100101001001100', '100001100010100100101000111110100001100001100001011110', '1000010000100001100010111', '111111000000010000001000000101111101000000100000010000000111111', '11100001011010000111', '000100000010000001000000100000010000001000000100000010001111111', '001010010010111010', '011111010000011000001100000110000011000001100000110000011000001', '0111110001100011000110001', '000100000101000010100010001001000100100010100000110000011000001', '0010001010100011000110001', '010001010101011010101101010110101011001001100000110000011000001', '0101010101101011000110001', '100000110000010100010001010000010000010100010001010000011000001', '1000101010001000101010001', '000100000010000001000001010001000100100010100000110000011000001', '011101000100001011111000110001', '111111110000000100000001000000010000000100000001000000011111111', '111111000001000001000001011111', '011111010000111000101100010110010011010001101000111000010111110', '111111100010000001000000100000010001001000010100000110000001000', '011111110000001000000100000001111100000001000000100000011111110', '111111000000010000001000000100111100000001000000100000011111110', '000010000001000000100000010001111111000100100010010001001000100', '011111010000010000001000000101111101000000100000010000001111111', '011111010000011000001100000111111101000000100000001000000011110', '100000001000000010000000100000001000000010000000100000011111111', '011111010000011000001100000101111101000001100000110000010111110', '011100000001000000010000000101111111000001100000110000010111110', '11', '1', '100001000001000010000010000010000100000100001', '000010000100010000100010001000010001000010000', '001000000000100001000001000001000010000111110', '101111111', '001010010100100100010010001', '100010010001001001010010100', '000000000000010000100111100010000100000000000', '000000000000000000000111100000000000000000000', '011111100000000000000000000000000000000000000000000000000000000', '000000000', '000100000000000000', '000000000', '000000000000000000010010000', '011111101000000100100010000001001000100010010111001000000111111']
  datas = [[7,9,0], [5,6,0], [7,9,0], [5,6,0], [7,9,0], [5,6,0], [7,9,0], [5,6,0], [7,9,0], [5,6,0], [7,9,0], [4,6,0], [7,9,0], [5,6,-1], [7,9,0], [5,6,0], [7,9,0], [1,6,0], [7,9,0], [5,6,-1], [7,9,0], [4,6,0], [7,9,0], [2,6,0], [7,9,0], [5,5,0], [7,9,0], [5,5,0], [7,9,0], [5,5,0], [7,9,0], [4,6,-1], [7,9,0], [5,6,-1], [6,9,0], [5,5,0], [7,9,0], [4,5,0], [7,9,0], [3,6,0], [7,9,0], [5,5,0], [7,9,0], [5,5,0], [7,9,0], [5,5,0], [7,9,0], [5,5,0], [7,9,0], [5,6,-1], [7,9,0], [5,6,0], [7,9,0], [7,9,0], [7,9,0], [7,9,0], [7,9,0], [7,9,0], [7,9,0], [7,9,0], [7,9,0], [7,9,0], [1,2,0], [1,1,0], [5,9,0], [5,9,0], [5,9,0], [1,9,0], [3,9,0], [3,9,0], [5,9,0], [5,9,0], [7,9,0], [1,9,0], [2,9,0], [1,9,0], [3,9,0], [7,9,0]]
  #          A         a        B        b        C        c        D        d        E        e        F        f        G         g       H         h        I        i        J        j         K        k        L        l        M        m        N        n        O        o        P         p        Q         q        R        r        S        s        T        t        U        u        V        v        W        w        X         x       Y        y         Z         z       0        1        2        3        4        5        6        7        8        9        ,         .       /        \        ?         !       (         )       +        -        _        :         ;        '        "     missing
  total_length, total_height,indexes,out,curlength = 1,0,[],[],1
  for a in text:
    if a == " ":
      indexes.append(-1)
      total_length += 4
    else:
      try: index = valtext.index(a)
      except: index = 77
      if datas[index][1] > total_height-2: total_height = datas[index][1]+2
      total_length += ((datas[index][0]) + 1)
      indexes.append(index)
  for a in range(total_height):
    out.append([])
    for b in range(total_length): out[a].append([background_color[0], background_color[1], background_color[2], background_opacity])
  for a in indexes:
    if a == -1:
      curlength += 4
      continue
    for b in range(datas[a][1]):
      for c in range(datas[a][0]):
        x = (b*datas[a][0]) + c
        if data[a][x] == "1": out[(total_height-b)-2][c+curlength] = [text_color[0], text_color[1], text_color[2], text_opacity]
    curlength += datas[a][0]+1
  if return_size: return out, total_length, total_height
  return out

if __name__ == "__main__":
  main()
